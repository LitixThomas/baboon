
<div class="beige-noise">
  <div class="p-wrapper">
    <div class="container"></div>
    <div class="row">
      <div class="col-sm-12">
        <section id="exports">
          <h1>exports</h1>
          <h5 class="subheader"></h5>
          <p>
            <!--mixin labelForSymbolType(symbol)--><span class="label label-info radius ctx-type">method</span><span>module.exports()</span>
          </p>
        </section>
        <div class="bs-example">
          <table class="table">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>baboon</td>
                <td>!Object</td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <tabset>
          <tab heading="Description">
            <div class="well"><p>Auth Object</p>
            </div>
          </tab>
          <tab heading="Source">
            <div hljs="hljs">module.exports = function (baboon) {

    var pub = {};
    var config = baboon.config;
    var rights = baboon.rights;
            </div>
          </tab>
        </tabset>
        <hr/>
        <section id="restrictedUser">
          <h1>restrictedUser</h1>
          <h5 class="subheader"></h5>
          <p>
            <!--mixin labelForSymbolType(symbol)--><span class="label label-info radius ctx-type">method</span><span>pub.restrictedUser()</span>
          </p>
        </section>
        <div class="bs-example">
          <table class="table">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>res</td>
                <td>!Object</td>
                <td></td>
              </tr>
              <tr>
                <td>next</td>
                <td>!Function</td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <tabset>
          <tab heading="Description">
            <div class="well"><p>@param {!Object} req</p>
            </div>
          </tab>
          <tab heading="Source">
            <div hljs="hljs">pub.restrictedUser = function (req, res, next) {

        // check session and user when rights is enabled and masterLoginPage is true
        if (config.rights.enabled &amp;&amp; config.rights.masterLoginPage) {

            if (req.session.user &amp;&amp; rights.userIsInRole(req.session.user, 'User')) {
                next();
            }
            else {
                //res.redirect('/login');
                res.send(404, 'Access denied');
            }
        }
        else {
            next();
        }
    };
            </div>
          </tab>
        </tabset>
        <hr/>
        <section id="restrictedAdmin">
          <h1>restrictedAdmin</h1>
          <h5 class="subheader"></h5>
          <p>
            <!--mixin labelForSymbolType(symbol)--><span class="label label-info radius ctx-type">method</span><span>pub.restrictedAdmin()</span>
          </p>
        </section>
        <div class="bs-example">
          <table class="table">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>res</td>
                <td>!Object</td>
                <td></td>
              </tr>
              <tr>
                <td>next</td>
                <td>!Function</td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <tabset>
          <tab heading="Description">
            <div class="well"><p>@param {!Object} req</p>
            </div>
          </tab>
          <tab heading="Source">
            <div hljs="hljs">pub.restrictedAdmin = function (req, res, next) {

        // check session and user when rights is enabled and masterLoginPage is true
        if (config.rights.enabled &amp;&amp; config.rights.masterLoginPage) {

            if (req.session.user &amp;&amp; rights.userIsInRole(req.session.user, 'Admin')) {
                next();

            }
            else {
                //res.redirect('/login');
                res.send(404, 'Access denied');
            }
        }
        else {
            next();
        }
    };

    return pub;
};
            </div>
          </tab>
        </tabset>
        <hr/>
      </div>
    </div>
  </div>
</div>