
<div class="beige-noise">
  <div class="p-wrapper">
    <div class="container"></div>
    <div class="row">
      <div class="col-sm-12">
        <section id="exports">
          <h1>exports</h1>
          <h5 class="subheader"></h5>
          <p>
            <!--mixin labelForSymbolType(symbol)--><span class="label label-info radius ctx-type">method</span><span>module.exports()</span><span title="return value" class="glyphicon glyphicon-arrow-right"></span><span>Object</span>
          </p>
        </section>
        <div class="bs-example">
          <table class="table">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>app</td>
                <td>!Object</td>
                <td></td>
              </tr>
              <tr>
                <td>routes</td>
                <td>Array.&lt;string&gt;</td>
                <td></td>
              </tr>
              <tr>
                <td>baboon</td>
                <td>!Object</td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <tabset>
          <tab heading="Description">
            <div class="well"><p>Config expressJs stack</p>
            </div>
          </tab>
          <tab heading="Source">
            <div hljs="hljs">module.exports = function (app, routes, baboon) {

    var loggers = baboon.loggers;
    var config = baboon.config;
    var rootPath = config.path.root;

    app.engine('html', require('ejs').renderFile);
    app.set('view engine', 'html');
    app.use(favicon());

    if (app.get('env') === 'development') {

        // Disable caching of scripts for easier testing
        app.use(function noCache(req, res, next) {

            if (req.url.indexOf('/app/') === 0 || req.url.indexOf('/common/') === 0 ||
                req.url.indexOf('/api/') === 0 || req.url.indexOf('/assets/') === 0) {

                res.header('Cache-Control', 'no-cache, no-store, must-revalidate');
                res.header('Pragma', 'no-cache');
                res.header('Expires', 0);
            }
            next();
        });

        // Logger in development mode
        app.use(log4js.connectLogger(loggers.express, {level: 'auto', format: ':status :method :url'}));

        // Static path for files and partial views
        app.use(express.static(path.join(rootPath, '.tmp')));
        app.use(express.static(path.join(rootPath, 'client')));

        // Path for application views
        app.set('views', rootPath + '/.tmp/views');
    }
    else if (app.get('env') === 'production') {

        // Enable compress
        app.use(compress());

        // Disable caching for rest api
        app.use(function noCache(req, res, next) {

            if (req.url.indexOf('/api/') === 0) {
                res.header('Cache-Control', 'no-cache, no-store, must-revalidate');
                res.header('Pragma', 'no-cache');
                res.header('Expires', 0);
            }
            next();
        });

        // Logger in production mode
        app.use(log4js.connectLogger(loggers.express, {level: 'auto'}));

        // Path for favicon with cache
        //app.use(express.favicon(path.join(rootPath, '.dist', 'public', 'favicon.ico'), {maxAge:oneMonth}));

        // Static path for files with cache
        app.use(express.static(path.join(rootPath, '.dist', 'public'), {maxAge: oneMonth}));

        // Static path for partial views without cache
        app.use(express.static(path.join(rootPath, '.dist', 'views', 'partials')));

        // Path for application views
        app.set('views', rootPath + '/.dist/views');
    }

    app.use(bodyParser.json());
    app.use(bodyParser.urlencoded());
    app.use(cookieParser());
    app.use(session({
        store: baboon.session.getSessionStore(),
        key: config.session.key,
        secret: config.session.secret,
        cookie: {expires: false}
    }));

    // Enable livereload
    if (app.get('env') === 'development' &amp;&amp; config.livereload) {
        app.use(require('connect-livereload')());
    }

    app.use(baboon.middleware.session.initSession);
    app.use('/api/', baboon.transport.processRequest);
    app.use(baboon.middleware.session.checkActivitySession);
    app.use('/', routes);
    app.use(baboon.errorHandler);

    // Overwrite express app listen
    app.listen = function(){
        var server = baboon.getServer(app);
        return server.listen.apply(server, arguments);
    };
};
            </div>
          </tab>
        </tabset>
        <hr/>
      </div>
    </div>
  </div>
</div>