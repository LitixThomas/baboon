
<div class="beige-noise">
  <div class="p-wrapper">
    <div class="container"></div>
    <div class="row">
      <div class="col-sm-12">
        <section id="exports">
          <h1>exports</h1>
          <h5 class="subheader"></h5>
          <p>
            <!--mixin labelForSymbolType(symbol)--><span class="label label-info radius ctx-type">method</span><span>module.exports()</span><span title="return value" class="glyphicon glyphicon-arrow-right"></span><span>Object</span>
          </p>
        </section>
        <div class="bs-example">
          <table class="table">
            <thead>
              <tr>
                <th style="width:20%">Option name</th>
                <th style="width:20%">Type</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>io</td>
                <td>!Object</td>
                <td></td>
              </tr>
              <tr>
                <td>baboon</td>
                <td>!Object</td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
        <tabset>
          <tab heading="Description">
            <div class="well"><p>SocketIO Configuration Object</p>
            </div>
          </tab>
          <tab heading="Source">
            <div hljs="hljs">module.exports = function(io, baboon) {

    // config for all
    io.configure(function () {

        // transports
        io.set('transports',
            [
                'websocket',
                'htmlfile',
                'xhr-polling',
                'jsonp-polling'
            ]
        );

        // logger
        io.set('logger', baboon.loggers.socket);

        // authorization
        io.set('authorization', function (data, callback) {

            // check if cookie exists
            if (!data.headers.cookie) {
                callback(null, false);
            }
            else {

                // save sessionID and session store for socket
                data.sessionID = baboon.session.getSessionId(data.headers.cookie);
                data.sessionStore = baboon.session.getSessionStore();

                baboon.session.getSessionById(data.sessionID, function(error, session) {

                    if (error || !session) {
                        return callback(null, false);
                    }
                    else {

                        // save session in socket
                        data.session = new Session(data, session);

                        // check restricted socket connection
                        if (baboon.config.rights.enabled &amp;&amp; baboon.config.rights.masterLoginPage) {

                            // by masterLoginPage, the user must not be a guest
                            if (session.user &amp;&amp; session.user.id !== -1) {

                                // connect successfully
                                return callback(null, true);
                            }
                            else {

                                // connect failed
                                return callback(null, false);
                            }
                        }
                        else {

                            // by not master LoginPage, the user must be a guest or higher
                            if (session.user &amp;&amp; session.user.id &gt;= -1) {

                                // connect successfully
                                return callback(null, true);
                            }
                            else {

                                // connect failed
                                return callback(null, false);
                            }
                        }
                    }
                });
            }
        });
    });

    // production config
    io.configure('production', function () {
        io.enable('browser client minification');
        io.enable('browser client etag');
    });

    // socket connection event
    io.sockets.on('connection', function (socket) {
        baboon.transport.registerSocketEvents(socket);
    });
};
            </div>
          </tab>
        </tabset>
        <hr/>
      </div>
    </div>
  </div>
</div>